<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>MHD · Dante</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Dante</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../input/">Input Parameters</a></li></ul></li><li><span class="tocitem">Method</span><ul><li class="is-active"><a class="tocitem" href>MHD</a><ul class="internal"><li><a class="tocitem" href="#Ideal-MHD"><span>Ideal MHD</span></a></li></ul></li><li><a class="tocitem" href="../fv/">Finite Volume</a></li><li><a class="tocitem" href="../test/">Standard Test</a></li></ul></li><li><a class="tocitem" href="../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Method</a></li><li class="is-active"><a href>MHD</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>MHD</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/henry2004y/Dante.jl/blob/master/docs/src/mhd.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Magnetohydrodynamics-Model"><a class="docs-heading-anchor" href="#Magnetohydrodynamics-Model">Magnetohydrodynamics Model</a><a id="Magnetohydrodynamics-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Magnetohydrodynamics-Model" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>As of June 2021, KaTeX lacks the full support for equation numbering.</p></div></div><h2 id="Ideal-MHD"><a class="docs-heading-anchor" href="#Ideal-MHD">Ideal MHD</a><a id="Ideal-MHD-1"></a><a class="docs-heading-anchor-permalink" href="#Ideal-MHD" title="Permalink"></a></h2><p>The ideal MHD equations can be written in (near) conservative form as</p><p class="math-container">\[\begin{aligned}
\frac{\partial \rho}{\partial t} + \nabla\cdot(\rho \mathbf{u}) &amp;= 0, \\
\frac{\partial \rho \mathbf{u}}{\partial t} + \nabla\cdot \left[ \rho \mathbf{u} \mathbf{u} + \bar{\bar{I}} (p + \frac{1}{2} B^2)
- \mathbf{B}\mathbf{B} \right] &amp;= -\mathbf{B}\nabla\cdot\mathbf{B}, \\
\frac{\partial \mathbf{B}}{\partial t} + \nabla\cdot (\mathbf{u}\mathbf{B} - \mathbf{B}\mathbf{u})
&amp;= -\mathbf{u}\nabla\cdot\mathbf{B}, \\
\frac{\partial e}{\partial t} + \nabla\cdot\left[ \mathbf{u} ( e + p + \frac{1}{2} B^2 )
-\mathbf{u}\cdot\mathbf{B}\mathbf{B} \right] &amp;= -\mathbf{u}\cdot\mathbf{B}\nabla\cdot\mathbf{B},
\end{aligned}\]</p><p>where <span>$\rho$</span> is mass density, <span>$\mathbf{u}$</span> is velocity, <span>$p$</span> is pressure, <span>$\mathbf{B}$</span> is the magnetic field and <span>$\bar{\bar{I}}$</span> is the identity matrix.  The total energy density is</p><p class="math-container">\[  \tag{totalE}
  e = \frac{p}{\gamma-1} + \frac{\rho u^2}{2} + \frac{B^2}{2},\]</p><p>where <span>$\gamma$</span> is the adiabatic index.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>We keep the divergence of the magnetic field on the RHS because of numerical accuracy. Even though physically valid by far in nature, it is not guaranteed to be zero in a numerical model.</p></div></div><p>We can also substitute the energy equation with pressure equation for a non-conservative form:</p><p class="math-container">\[  \tag{pressure}
  \frac{\partial p}{\partial t} + \nabla\cdot (p \mathbf{u}) = -(\gamma - 1) p \nabla \cdot \mathbf{u}, \]</p><p>The source terms proportional to <span>$\nabla\cdot\mathbf{B}$</span> and <span>$\nabla\cdot\mathbf{u}$</span> on the right hand sides are not evaluated as a flux, but the ingredients (normal components of <span>$\mathbf{B}$</span> and <span>$\mathbf{u}$</span> are calculated and used later. In total, there are 8 primitive variables <span>$(\rho,\mathbf{u},\mathbf{b},p)$</span>. Note that in BAT-S-RUS, the momentum <span>$\rho\mathbf{u}$</span> is actually stored instead of velocity <span>$\mathbf{u}$</span>. </p><p>In Cartesian coordinates, we can express the above equations in more detailed and compact form. If we use <span>$\mathbf{A}$</span> to represent all the state variables, we have</p><p class="math-container">\[\frac{\partial\mathbf{A}}{\partial t}+\nabla\cdot\vec{\mathbf{F}}(\mathbf{B})=\mathbf{S},\]</p><p>by defining the state and flux vectors as</p><p class="math-container">\[\begin{aligned}
\text{state: } \mathbf{A} = 
	\begin{bmatrix}
	\rho \\ \rho u_x \\ \rho u_y \\ \rho u_z \\ B_x \\ B_y \\ B_z \\ p \\ e \\
	\end{bmatrix},
\quad
\text{flux: } \vec{\mathbf{F}} = 
	&amp;\begin{bmatrix}
	\rho u_x \\ \rho u_x u_x + (p+\frac{1}{2}B^2)- B_xB_x \\ \rho u_x u_y - B_x B_y \\ \rho u_x u_z - B_xB_z \\ 0 \\ u_x B_y - B_x u_y \\
	u_x B_z - B_x u_z \\ p u_x \\u_x (e+p+\frac{1}{2}B^2) - (u_xB_x+u_yB_y+u_zB_z)B_x
	\end{bmatrix}\widehat{x} + \\
	&amp;\begin{bmatrix}
	\rho u_y \\ \rho u_y u_x - B_yB_x \\ \rho u_y u_y + (p+\frac{1}{2}B^2)- B_y B_y \\ \rho u_y u_z - B_yB_z \\ u_y B_x - B_y u_x \\ 0 \\
	u_y B_z - B_y u_z \\ p u_y \\ u_y (e+p+\frac{1}{2}B^2) - (u_xB_x+u_yB_y+u_zB_z)B_y
	\end{bmatrix}\widehat{y} +\\
	&amp;\begin{bmatrix}
	\rho u_z \\ \rho u_z u_x - B_zB_x \\ \rho u_z u_y - B_z B_y \\ \rho u_z u_z + (p+\frac{1}{2}B^2) - B_zB_z \\ u_z B_x - B_z u_x \\  u_z B_y - B_z u_y \\ 0 \\ p u_z \\u_z (e+p+\frac{1}{2}B^2) - (u_xB_x+u_yB_y+u_zB_z)B_z
	\end{bmatrix}\widehat{z}, \\
\text{source: } \mathbf{S} = 
	&amp;\begin{bmatrix}
	0 \\ 
	-B_x(\frac{\partial B_x}{\partial x}+\frac{\partial B_y}{\partial y}+\frac{\partial B_z}{\partial z}) \\
	-B_y(\frac{\partial B_x}{\partial x}+\frac{\partial B_y}{\partial y}+\frac{\partial B_z}{\partial z}) \\
	-B_z(\frac{\partial B_x}{\partial x}+\frac{\partial B_y}{\partial y}+\frac{\partial B_z}{\partial z}) \\
	-u_x(\frac{\partial B_x}{\partial x}+\frac{\partial B_y}{\partial y}+\frac{\partial B_z}{\partial z}) \\
	-u_y(\frac{\partial B_x}{\partial x}+\frac{\partial B_y}{\partial y}+\frac{\partial B_z}{\partial z}) \\
	-u_z(\frac{\partial B_x}{\partial x}+\frac{\partial B_y}{\partial y}+\frac{\partial B_z}{\partial z}) \\
	-(\gamma-1)p(\frac{\partial u_x}{\partial x}+\frac{\partial u_y}{\partial y}+\frac{\partial u_z}{\partial z}) \\
	-(u_xB_x+u_yB_y+u_zB_z)(\frac{\partial B_x}{\partial x}+\frac{\partial B_y}{\partial y}+\frac{\partial B_z}{\partial z}) \\
	\end{bmatrix}.
\end{aligned}\]</p><p>Note that the last two equations overspecify the system. We only need to choose one of them.</p><p>Up to this stage, all the equations above are exact. The next question is how do we solve this system numerically?</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../input/">« Input Parameters</a><a class="docs-footer-nextpage" href="../fv/">Finite Volume »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 1 June 2021 17:34">Tuesday 1 June 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
